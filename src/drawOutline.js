export default function drawOutline(data, cut) {
    return new Promise((resolve) => {
        const { artworkUrl512, kind } = data;
        const canvas = document.createElement('canvas');
        canvas.width = 512;
        canvas.height = 512;
        const ctx = canvas.getContext('2d');
        const appIcon = new Image();
        appIcon.setAttribute('crossOrigin', 'anonymous');
        appIcon.src = artworkUrl512;
        appIcon.onload = function () {
            ctx.drawImage(appIcon, 0, 0);
            ctx.globalCompositeOperation = 'destination-in';
            if (kind.startsWith('software')) {
                if (cut === 'Rounded') {
                    const outline = new Path2D('M512,352.563165 C512,358.649887 512,364.736609 511.964307,370.832153 C511.937537,375.957349 511.875074,381.082546 511.732302,386.207742 C511.428911,397.366733 510.759666,408.640401 508.751931,419.675893 C506.717427,430.887811 503.397972,441.323452 498.142168,451.512096 C492.993444,461.515491 486.265301,470.672039 478.234362,478.611241 C470.203422,486.550444 460.932149,493.210553 450.813166,498.300464 C440.515717,503.48741 429.968416,506.777769 418.626946,508.789034 C407.455017,510.773834 396.060006,511.435434 384.763151,511.73536 C363.043922,512 356.886869,512 350.729815,512 L232.004914,512 L161.279108,512 C137.614607,511.929429 132.430189,511.876501 127.245772,511.73536 C115.948917,511.435434 104.553907,510.773834 93.3819778,508.789034 C82.0405068,506.777769 71.4932065,503.48741 61.1957576,498.300464 C51.0678508,493.210553 41.8055008,486.550444 33.7745615,478.611241 C25.7436222,470.672039 19.0154797,461.515491 13.857832,451.512096 C8.6109516,441.323452 5.29149669,430.887811 3.24806879,419.675893 C1.24033396,408.640401 0.580012284,397.366733 0.276621243,386.207742 C0.133848989,381.082546 0.0713861273,375.957349 0.0446163296,370.832153 C-8.0261073e-13,364.736609 0,358.649887 0,352.563165 L0,282.645252 L0,229.354748 L0,159.436835 C0,153.350113 0,147.25457 0.0446163296,141.176669 C0.0713861273,136.042651 0.133848989,130.917454 0.276621243,125.792258 C0.580012284,114.624446 1.24033396,103.359599 3.24806879,92.3152861 C5.29149669,81.1033674 8.6109516,70.6765477 13.857832,60.4879041 C19.0154797,50.4756872 25.7436222,41.31914 33.7745615,33.3887585 C41.8055008,25.4407344 51.0678508,18.7894467 61.1957576,13.6995355 C71.4932065,8.51258969 82.0405068,5.22223119 93.3819778,3.21096647 C104.553907,1.22616577 115.948917,0.564565534 127.245772,0.264640094 C148.965001,0 155.122055,0 161.279108,0 L232.004914,0 L345.679247,0 L279.995086,0.0264640094 L350.729815,0 C374.385393,0.0705706917 379.569811,0.12349871 384.763151,0.264640094 C396.060006,0.564565534 407.455017,1.22616577 418.626946,3.21096647 C429.968416,5.22223119 440.515717,8.51258969 450.813166,13.6995355 C460.932149,18.7894467 470.203422,25.4407344 478.234362,33.3887585 C486.265301,41.31914 492.993444,50.4756872 498.142168,60.4879041 C503.397972,70.6765477 506.717427,81.1033674 508.751931,92.3152861 C510.759666,103.359599 511.428911,114.624446 511.732302,125.792258 C511.875074,130.917454 511.937537,136.042651 511.964307,141.176669 C512,147.25457 512,153.350113 512,159.436835 L512,229.354748 L512,282.645252 L512,352.563165 Z')
                    ctx.fill(outline);
                } else {
                    const outline = new Path2D('M512, M512')
                    ctx.fill(outline);
                }
            }
            resolve(canvas.toDataURL());
        };
    });
}
